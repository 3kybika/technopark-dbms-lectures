---
title: Docker
description: |
  Вводная лекция про Docker.

   - Почему Docker?
   - Какие есть виды вируализации?
   - Что такое Dockerfile?
   - Работа с контейнерами.
---
<section class="slide">
    <h2>Docker</h2>
    <img src="docker.svg" style="position: absolute; bottom: 50px; right: 50px; width: 320px"/>
    <ul>
        <li>Почему Docker?</li>
        <li>Какие есть виды вируализации?</li>
        <li>Что такое Dockerfile?</li>
        <li>Работа с контейнерами.</li>
    </ul>
</section>

<section class="slide">
    <h2>Почему Docker?</h2>
    <h3>Как проходила сдача семестровых работ раньше?</h3>
    <ul>
        <li>Студентам выдавали по виртуальной машине;</li>
        <li>Каждый локально растраивал виртуальную машину и разворачивал там приложение и окружение;</li>
        <li>С преподавательской виртуальной машины скрипт осуществлял нагрузочное тестирование.
    </ul>
</section>

<section class="slide">
    <h2>Почему Docker?</h2>
    <h3>В чем проблема?</h3>
    <ul>
        <li class="next">В случае если виртуальная машина сломалась, её может восстановить только администратор;</li>
        <li class="next">Производительность виртуальной машины не предсказуема;</li>
        <li class="next">Нет никакой гарантии, что на тестируемой машине и в репозитории студента один и тот же проект.
            <img src="facepalm.png" style="z-index: -1; position: absolute; bottom: 0px; right: 50px; height: 300px"/>
        </li>
    </ul>
</section>

<section class="slide">
    <h2>Почему Docker?</h2>
    <h3>Что делать?</h3>
    <ul>
        <li>Студент пишет инструкцию по установке приложения;</li>
        <li>Преподавать устанавливает приложение на эталонном компьтере и проводит нагрузочное тестирование.</li>
    </ul>
    <div class="next">
        <p>Но есть проблема...</p>
        <img src="queue.jpg" style="z-index: -1; position: absolute; bottom: 50px; right: 50px; height: 300px"/>
    </div>
</section>

<section class="slide">
    <h2>Почему Docker?</h2>
    <h3>Решение:</h3>
    <ul>
        <li>Студент пишет инструкцию по установке приложения: Dockerfile;</li>
        <li>Автоматизированные установка и проведение нагрузочного тестирования на эталонном компьтере.</li>
    </ul>
    <img src="profit.jpg" style="z-index: -1; position: absolute; bottom: 50px; right: 50px; width: 400px"/>
</section>

<section class="slide">
    <h2>Docker</h2>
	<dl>
		<dt>Docker</dt>
		<dd>
			<p>Программное обеспечение для автоматизации развёртывания и управления приложениями в среде виртуализации на уровне операционной системы.</p>
			<p>Позволяет «упаковать» приложение со всем его окружением и зависимостями в контейнер, который может быть перенесён на любую Linux-систему с поддержкой cgroups в ядре, а также предоставляет среду по управлению контейнерами.</p>
		</dd>
	</dl>
</section>

<section class="slide">
    <h2>Виды виртуализации</h2>
    <dl style="font-size: 90%">
        <dt>Динамическая трансляция (KVM, VMware, VirutalBox)</dt>
        <dd>При динамической (бинарной) трансляции проблемные команды гостевой операционной системы перехватываются гипервизором. После того как эти команды заменяются на безопасные, происходит возврат управления гостевой системе.</dd>

        <dt>Паравиртуализация (Xen)</dt>
        <dd>Техника виртуализации, при которой гостевые операционные системы подготавливаются для исполнения в виртуализированной среде, для чего их ядро незначительно модифицируется.</dd>

        <dt>Контейнерная виртуализация (OpenVZ, LXC, Docker)</dt>
        <dd>Метод вир­ту­а­ли­за­ции, при кото­ром ядро опе­ра­ци­он­ной системы под­дер­жи­вает несколько изо­ли­ро­ван­ных экзем­пля­ров про­стран­ства поль­зо­ва­те­ля, вме­сто одно­го.</dd>
    </dl>
</section>

<section class="slide">
	<h2>Производительность</h2>
	<div style="width: 100%; text-align: center">
		<img src="docker-rtl.png" style="max-width: 100%; max-height: 460px" />
	</div>
    <footer class="footer">Источник: <a href="http://domino.research.ibm.com/library/cyberdig.nsf/papers/0929052195DD819C85257D2300681E7B/$File/rc25482.pdf">http://domino.research.ibm.com/library/cyberdig.nsf/papers/0929052195DD819C85257D2300681E7B/$File/rc25482.pdf</a> (копия: <a href="rc25482.pdf">rc25482.pdf</a>)</footer>	
</section>

<section class="slide">
	<h2>Производительность</h2>
	<div style="width: 100%; text-align: center">
		<img src="docker-netcpu.png" style="max-width: 100%; max-height: 460px" />
	</div>
</section>

<section class="slide">
	<h2>Производительность</h2>
	<div style="width: 100%; text-align: center">
		<img src="docker-io-seq.png" style="max-width: 100%; max-height: 460px" />
	</div>
</section>

<section class="slide">
	<h2>Производительность</h2>
	<div style="width: 100%; text-align: center">
		<img src="docker-io-rnd.png" style="max-width: 100%; max-height: 460px" />
	</div>
</section>

<section class="slide">
	<h2>Dockerfile</h2>
	<pre><code>FROM ubuntu:16.04
MAINTAINER Artem V. Navrotskiy
RUN apt-get -y update
RUN apt-get install -y openjdk-8-jdk-headless
ENV WORK /opt/tech-db-hello
ADD java-spring/ $WORK/java-spring/
ADD common/ $WORK/common/
WORKDIR $WORK/java-spring
RUN ./gradlew assemble
EXPOSE 5000
CMD java -Xmx300M -Xmx300M -jar \
    $WORK/java-spring/build/libs/java-spring.jar
</code></pre>
</section>

<section class="slide">
	<h2>Dockerfile</h2>
	<h3>Сборка:</h3>
	<pre><code class="bash">docker build -t hello-docker
</code></pre>
	<h3>Результат сборки:</h3>
	<pre><code class="bash">docker history hello-docker
</code></pre>
	<pre style="font-size: 50%"><code>
IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT
142e08487e9f        3 minutes ago       /bin/sh -c #(nop)  CMD ["/bin/sh" "-c" "java    0 B                 
89554758e753        3 minutes ago       /bin/sh -c #(nop)  EXPOSE 5000/tcp              0 B                 
5bf1ec77528d        3 minutes ago       /bin/sh -c ./gradlew assemble                   209.4 MB            
f627d2a79e3b        5 minutes ago       /bin/sh -c #(nop)  WORKDIR /opt/tech-db-hello   0 B                 
c86551883943        5 minutes ago       /bin/sh -c #(nop) ADD dir:f6c361eff4dcd18df9a   3.968 MB            
854f85a7870a        5 minutes ago       /bin/sh -c #(nop) ADD dir:b3d037b5a457bd71162   23.65 MB            
92a00899fc26        5 minutes ago       /bin/sh -c #(nop)  ENV WORK=/opt/tech-db-hell   0 B                 
329813b55a21        5 minutes ago       /bin/sh -c apt-get install -y openjdk-8-jdk-h   186.1 MB            
7c973a535a50        5 minutes ago       /bin/sh -c apt-get -y update                    39.76 MB            
f0c74fcd39ff        5 minutes ago       /bin/sh -c #(nop)  MAINTAINER Artem V. Navrot   0 B                 
104bec311bcd        9 weeks ago         /bin/sh -c #(nop)  CMD ["/bin/bash"]            0 B                 
&lt;missing>           9 weeks ago         /bin/sh -c mkdir -p /run/systemd &amp;&amp; echo 'doc   7 B                 
&lt;missing>           9 weeks ago         /bin/sh -c sed -i 's/^#\s*\(deb.*universe\)$/   1.895 kB            
&lt;missing>           9 weeks ago         /bin/sh -c rm -rf /var/lib/apt/lists/*          0 B                 
&lt;missing>           9 weeks ago         /bin/sh -c set -xe   &amp;&amp; echo '#!/bin/sh' > /u   745 B               
&lt;missing>           9 weeks ago         /bin/sh -c #(nop) ADD file:7529d28035b43a2281   128.9 MB  
</code></pre>
</section>